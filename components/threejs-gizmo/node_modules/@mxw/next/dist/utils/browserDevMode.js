"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const womAsync_module_1 = __importDefault(require("../wrappers/womAsync.module"));
const sleep_1 = __importDefault(require("./sleep"));
/**
 * Opens devtools for the specified webview and refreshes on "F5"
 * @param ww Webview/Webtabel to open devtools
 * @param initHandler callback function to run after refresh
 */
function browserDevMode(ww, initHandler) {
    let webview;
    if (ww.webview) {
        webview = ww.webview;
    }
    else {
        webview = ww;
    }
    webview.browserWindow.webContents.openDevTools({ mode: 'detach' });
    //reload overlay on F5
    womAsync_module_1.default.selfAwareListener('input-keyboard', async (event) => {
        if (event.keyName == 'F5' && event.type == 'keyDown') {
            // we have to close devtools and reopen, otherwise the reload is buggy
            webview.browserWindow.webContents.closeDevTools();
            await (0, sleep_1.default)(1000);
            webview.browserWindow.reload();
            await (0, sleep_1.default)(1000);
            webview.browserWindow.webContents.openDevTools({ mode: 'detach' });
            if (initHandler) {
                initHandler(webview);
            }
        }
    }, webview);
}
exports.default = browserDevMode;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnJvd3NlckRldk1vZGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdXRpbHMvYnJvd3NlckRldk1vZGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFDQSxrRkFBbUQ7QUFDbkQsb0RBQTRCO0FBQzVCOzs7O0dBSUc7QUFDSCxTQUF3QixjQUFjLENBQ3BDLEVBQXNCLEVBQ3RCLFdBQXVDO0lBRXZDLElBQUksT0FBZ0IsQ0FBQztJQUNyQixJQUFLLEVBQWUsQ0FBQyxPQUFPLEVBQUU7UUFDNUIsT0FBTyxHQUFJLEVBQWUsQ0FBQyxPQUFPLENBQUM7S0FDcEM7U0FBTTtRQUNMLE9BQU8sR0FBRyxFQUFhLENBQUM7S0FDekI7SUFFRCxPQUFPLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxZQUFZLENBQUMsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLENBQUMsQ0FBQztJQUVuRSxzQkFBc0I7SUFDdEIseUJBQVEsQ0FBQyxpQkFBaUIsQ0FDeEIsZ0JBQWdCLEVBQ2hCLEtBQUssRUFBRSxLQUFLLEVBQUUsRUFBRTtRQUNkLElBQUksS0FBSyxDQUFDLE9BQU8sSUFBSSxJQUFJLElBQUksS0FBSyxDQUFDLElBQUksSUFBSSxTQUFTLEVBQUU7WUFDcEQsc0VBQXNFO1lBQ3RFLE9BQU8sQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLGFBQWEsRUFBRSxDQUFDO1lBQ2xELE1BQU0sSUFBQSxlQUFLLEVBQUMsSUFBSSxDQUFDLENBQUM7WUFDbEIsT0FBTyxDQUFDLGFBQWEsQ0FBQyxNQUFNLEVBQUUsQ0FBQztZQUMvQixNQUFNLElBQUEsZUFBSyxFQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2xCLE9BQU8sQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsQ0FBQyxDQUFDO1lBQ25FLElBQUksV0FBVyxFQUFFO2dCQUNmLFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQzthQUN0QjtTQUNGO0lBQ0gsQ0FBQyxFQUNELE9BQU8sQ0FDUixDQUFDO0FBQ0osQ0FBQztBQS9CRCxpQ0ErQkMifQ==