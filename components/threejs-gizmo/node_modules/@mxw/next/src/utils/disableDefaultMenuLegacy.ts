import { modules } from 'maxwhere';

/**
 * Disables default maxwhere menu
 * This method is legacy and should only be used with MaxWhere 5
 */
export default function disableDefaultMenuLegacy() {
  const where = modules.mxwStateProxy.where;

  const onMenuStateChange = (states: {
    currentState: number;
    nextState: number;
  }) => {
    //console.log('current:', states.currentState, 'next:', states.nextState)
    //  state can be where.menustates.EMPTY, CROSSHAIR, PEBBLES
    if (states.nextState === where.menustates.PEBBLES) {
      // in this example, we go to empty mode whenever pebbles ui would be displayed
      // but we could be going from EMPTY to CROSSHAIR, or from CROSSHAIR to EMPTY
      // setTimeout is used to make sure the current state change completes first
      if (states.currentState != where.menustates.EMPTY) {
        setTimeout(() => {
          where.menu.goMode(where.menustates.EMPTY);

          //overlay.show();
        }, 0);
      } else {
        setTimeout(() => {
          where.menu.goMode(where.menustates.CROSSHAIR);
          // TODO: close overlay
          //overlay.hide();
        }, 0);
      }
    }
  };

  modules.mxwStateProxy.where.on('menu-state-change', onMenuStateChange);
}
