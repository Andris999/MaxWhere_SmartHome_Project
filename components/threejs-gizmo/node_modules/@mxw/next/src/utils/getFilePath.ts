import { wom } from 'maxwhere';
import fs from 'fs';

/**
 * Gets full path of file. Only works if the file is already loaded in to the the wom resources. (added with wom.addResources)
 * @param fileName name of the file Example: "cube.mesh"
 * @returns full path
 */
export default function getFilePath(fileName: string) {
  let resourceKey = getFileResourceKey(fileName);

  if (resourceKey) {
    let resourcePaths = wom.resourcePaths[resourceKey];
    let found = false;
    let i = 0;

    while (!found && resourcePaths.length > i) {
      found = fs.existsSync(`${resourcePaths[i]}\\${fileName}`);
      if (found) {
        continue;
      }
      i++;
    }
    if (found) {
      return resourcePaths[i];
    }
  }
  return '';
}

function getFileResourceKey(fileName: string) {
  let resourceKeys = Object.keys(wom.resourcePaths);
  let found = false;
  let i = 0;
  while (!found && resourceKeys.length > i) {
    found = wom.getResourceFileList(resourceKeys[i]).includes(fileName);
    if (found) {
      continue;
    }
    i++;
  }
  if (found) {
    return resourceKeys[i];
  } else {
    return '';
  }
}
